<template>
    <van-swipe class="swipe" :autoplay="0" lazy-render>
        <van-swipe-item class="image-container" v-for="(image, index) in images" :key="index">
            <van-image :src="image" fit="contain" />
        </van-swipe-item>
    </van-swipe>
    <div class="diary-container">
        <h1 class="diary-title">{{ title }}</h1>
        <pre class="diary-content">{{ content }}</pre>
    </div>
    <van-action-bar style="padding: 0 30px;">
        <van-action-bar-icon icon="good-job-o" text="点赞" />
        <van-action-bar-icon icon="star" text="已收藏" color="#ff5000" />
        <van-action-bar-button type="primary" text="景点详情" to="/map" />
    </van-action-bar>
</template>

<script setup>
import { ref, onMounted } from 'vue';
import { useRoute } from 'vue-router';
import 'vant/lib/index.css';

const route = useRoute();
const images = ref([]);
const title = ref('');
const content = ref('');

onMounted(async () => {
    // 模拟从后端获取日记详情数据
    const diaryId = route.params.id;
    // 这里需要替换为实际的 API 请求
    const mockData = {
        images: [
            'http://47.93.189.31/res/Carto.jpg',
            'http://47.93.189.31/res/Carto.jpg',
            'http://47.93.189.31/res/Carto.jpg',
            'http://47.93.189.31/res/Carto.jpg',
            'http://47.93.189.31/res/Carto.jpg'
        ],
        title: '课程设计题目：个性化旅游系统的设计与实现',
        content: `问题描述
当前大家经常利用假期去各地旅游。个性化旅游系统可以帮助大家管理自己的旅游活动，具备旅游地点推荐、旅游路线规划、旅游场所查询、旅游日记交流等功能。
旅游前：需先按照旅游目的地的热度、评价和个人兴趣选择旅游目的地；
旅游中：在景点（包括学校）内部也需要根据游览的目标规划最优的参观线路，在游览过程中还可以给出相应的景点介绍和场所查询；
旅游后：可以根据所拍照片和游览经历生成旅游日记。

数据要求
景区和校园数量至少200个，景区和校园内部可以一致；
景区和校园内建筑物（景点、教学楼、办公楼、宿舍楼）数不少于20个；其它服务设施不少于10种（商店、饭店、洗手间、图书馆、食堂、超市、咖啡馆等），数量不少于50个；
建立景区和校园内部道路图
包括各种建筑物、服务设施等信息；
边数不能少于200条（尽量接近真实景区和校园，建议爬取真实地图数据）；
系统基础要求为多用户系统；系统需要能够支持多个用户登录使用；用户数不少于10人；

旅游推荐
用户可以根据自己的喜好选择不同的景点和学校作为旅游目的地；
在游览前，系统会向用户推荐旅游景点和学校，可以按照旅游热度、评价和个人兴趣进行推荐；
推荐算法基础要求为排序算法，可以按照用户选择的热度和评价进行排序；（核心算法为排序算法，考虑到用户通常只看前10个景点或者学校，要求不经过完全排序可以排好前10的景点或者学校，并且考虑数据动态变化）
用户可以输入景点和学校的名称、类别、关键字等进行查询，查询结果有多项时，可以对查询结果按照热度和评价进行排序。（核心算法为查找算法和排序算法）

旅游路线规划
当进入景区或者学校后，用户可以输入目标景点或者场所信息，系统会为用户规划从当前位置出发到达景点或者场所的最优旅游线路；（核心算法为最短路径算法）
当进入景区或者学校后，用户可以输入多个目标景点或者场所信息，系统会为用户规划从当前位置出发，参观多个景点或者场所的最优旅游线路。（核心算法为途经多点最短路径算法，从当前位置出发，参观完返回当前位置。）
设计导航功能的图形界面，包括地图展示和输出路径展示；
关于线路规划策略的要求：
最短距离策略：距离最短即可；
最短时间策略：假设每条道路拥挤度不一样，在这种情况下时间最短即可；拥挤度为小于等于1的一个正数，真实速度=拥挤度*理想速度；每条道路的拥挤度与理想速度自拟；
交通工具的最短时间策略：校区内可以选择自行车和步行，选择自行车时，只能走自行车道路，默认自行车在校区任何地点都有；景区内可以选择步行和电瓶车，选择电瓶车时只能走电瓶车路线，电瓶车路线固定，默认上车即走；不同交通工具可以选择时，考虑不同拥挤度的情况下时间最短；（时间最短的线路，可以是多种交通工具混合）

场所查询
在景区或者学校内部时，选中某个景点或者场所，会找出附近一定范围内的超市、卫生间等设施，并根据距离进行排序；（核心算法为排序，不能根据直线距离）
可以通过选择类别对结果进行过滤；
可以由用户输入类别名称查找某个地点附近的服务设施，并根据距离进行排序；（核心算法为查找和排序）

旅游日记管理
用户旅游过程中或者旅游结束时可以撰写旅游日记，通过文字、图片和视频等方式记录旅游内容；
需要对所有用户的旅游日记进行统一的管理；
用户可以根据浏览和查询所有用户的旅游日记，旅游日记的浏览量即为该日记的热度，每位同学浏览完可以对旅游日记进行评分；
用户在浏览所有旅游日记时，可以按照日记热度、评价和个人兴趣进行推荐，推荐算法基础要求为排序算法，可以根据热度和评分进行排序；（核心算法为排序算法）
用户可以输入旅游目的地，对目的地相关的旅游日记根据热度和评分进行排序；（核心算法为查找算法和排序算法）
用户可以输入旅游日记的名称进行精确查询； （核心算法为查找算法，考虑旅游日记数量较大，变化非常快的情况下进行高效查找）
可以按日记内容进行全文检索（核心算法为文本搜索）
可以对旅游日记进行压缩存储（核心算法为无损压缩）
使用AIGC算法根据拍摄的景点或者学校的照片、文字描述等信息进行旅游动画生成。

选做功能需求
选做一：室内导航策略：模拟教学楼的结构和景区内博物馆等建筑物的内部结构，进行室内导航，包括大门到电梯的导航、楼层间的电梯导航和楼层内到房间的导航；
选做二：美食推荐，在选中游览景点和学校后，可以按照用户选择的热度、评价和距离进行排序，并根据菜系进行过滤；（核心算法为排序算法，考虑到用户通常只看前10个美食，要求不经过完全排序可以排好前10的美食）；可以输入美食名称、菜系、饭店或窗口名称等进行基于内容的模糊查询，查询结果有多项时，可以对查询结果按照热度、评价和距离进行排序。（核心算法为模糊查找算法和排序算法）
选做三：采用基于内容推荐算法，针对个人兴趣进行景点、学校、美食和旅游日记的推荐；`
    };
    images.value = mockData.images;
    title.value = mockData.title;
    content.value = mockData.content;
});
</script>

<style scoped>
.swipe {
    width: 100%;
    aspect-ratio: 16 / 9;
}

.image-container {
    display: flex;
    justify-content: center;
    background-color: white;
}

.diary-container {
    padding: 20px;
}

.diary-title {
    font-size: 24px;
}

.diary-content {
    margin-top: 10px;
    font-size: 16px;
    line-height: 1.6;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-wrap: break-word;
    font-family: inherit;
}
</style>